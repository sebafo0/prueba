<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Memorice Matemático - 1° a 4° Medio</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
    background: #f5f5f5;
  }
  h1 {
    text-align: center;
    margin-bottom: 0.5em;
  }
  #controls {
    text-align: center;
    margin-bottom: 1em;
  }
  select, button {
    font-size: 1rem;
    padding: 0.4em 0.8em;
    margin: 0 0.5em;
  }
  #board {
    display: grid;
    grid-template-columns: repeat(4, 140px);
    grid-gap: 15px;
    justify-content: center;
    margin-bottom: 1em;
  }
  .card {
    background: #eee;
    border: 2px solid #ccc;
    height: 110px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    user-select: none;
    color: transparent;
    transition: background-color 0.3s, color 0.3s;
    padding: 0.5em;
    text-align: center;
    border-radius: 8px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
  }
  .card.flipped {
    background: #4caf50;
    color: black;
    cursor: default;
  }
  .card.matched {
    background: #2e7d32;
    color: white;
    cursor: default;
  }
  .card.wrong {
    background: #f44336;
    color: white;
    cursor: default;
  }
  #explanation {
    min-height: 3em;
    margin-bottom: 1em;
    font-style: italic;
    text-align: center;
    color: #333;
  }
  #scoreboard, #timer {
    font-weight: bold;
    font-size: 1.1rem;
    margin: 0.3em 1em;
  }
  #info-bar {
    text-align: center;
    margin-bottom: 1em;
  }

  /* Colores para dificultad */
  .board-facil .card { border-color: #81c784; }
  .board-medio .card { border-color: #4caf50; }
  .board-dificil .card { border-color: #388e3c; }
  .board-extremo .card { border-color: #1b5e20; }
</style>
</head>
<body>

<h1>Memorice Matemático - 1° a 4° Medio</h1>

<div id="controls">
  Curso: 
  <select id="curso-select">
    <option value="1medio">1° Medio</option>
    <option value="2medio">2° Medio</option>
    <option value="3medio">3° Medio</option>
    <option value="4medio">4° Medio</option>
  </select>
  Dificultad: 
  <select id="dificultad-select">
    <option value="facil">Fácil</option>
    <option value="medio">Medio</option>
    <option value="dificil">Difícil</option>
    <option value="extremo">Extremo</option>
  </select>
  <button id="start-btn">Iniciar Juego</button>
</div>

<div id="info-bar">
  <span id="scoreboard">Puntaje: 0</span>
  <span id="timer">Tiempo: 00:00</span>
</div>

<div id="board" class="board-facil"></div>

<div id="explanation"></div>

<script>
  // Banco de ejercicios por curso y dificultad
  const bancoOperaciones = {
    "1medio": {
      "facil": [
        { pregunta: "Simplifica: (a + b)²", respuesta: "a² + 2ab + b²", explicacion: "Producto notable cuadrado de binomio" },
        { pregunta: "Suma: 2x + 3x", respuesta: "5x", explicacion: "Suma de términos semejantes" },
        { pregunta: "Resuelve: x + 3 = 7", respuesta: "4", explicacion: "Despeja x" },
        { pregunta: "Área rectángulo base 4 cm altura 5 cm", respuesta: "20", explicacion: "Área = base × altura" },
        { pregunta: "Representa datos en gráfico XY", respuesta: "Puntos en plano", explicacion: "Nube de puntos" },
        { pregunta: "Sistema: x + y = 3, x - y = 1", respuesta: "x=2, y=1", explicacion: "Suma y resta para despejar" },
        { pregunta: "Homotecia: escala 2, punto (3,4)", respuesta: "(6,8)", explicacion: "Multiplica coordenadas por escala" },
        { pregunta: "Simplifica: 3(x + 2)", respuesta: "3x + 6", explicacion: "Distribución" }
      ],
      "medio": [
        { pregunta: "Producto: (x+2)(x+3)", respuesta: "x² + 5x + 6", explicacion: "Multiplica binomios" },
        { pregunta: "Resuelve sistema: 2x + y = 5, x - y = 1", respuesta: "x=2, y=1", explicacion: "Método sustitución" },
        { pregunta: "Área triángulo base 6 altura 4", respuesta: "12", explicacion: "Área = (base × altura)/2" },
        { pregunta: "Representa función lineal y=2x+1", respuesta: "Recta con pendiente 2", explicacion: "Pendiente e intercepto" },
        { pregunta: "Calcula media de: 2,4,6,8", respuesta: "5", explicacion: "Promedio aritmético" },
        { pregunta: "Homotecia inversa escala 0.5, punto (6,8)", respuesta: "(3,4)", explicacion: "Multiplica coordenadas por escala" },
        { pregunta: "Simplifica: (2x)²", respuesta: "4x²", explicacion: "Potencia de producto" },
        { pregunta: "Suma: 5a - 3a + 2a", respuesta: "4a", explicacion: "Suma términos semejantes" }
      ],
      "dificil": [
        { pregunta: "Resuelve sistema: 3x + 2y = 12, x - y = 1", respuesta: "x=3, y=2", explicacion: "Método eliminación" },
        { pregunta: "Simplifica: (x + 1)(x² - x + 1)", respuesta: "x³ + 1", explicacion: "Producto de binomios y trinomios" },
        { pregunta: "Área trapecio bases 3 y 5 altura 4", respuesta: "16", explicacion: "((B + b)/2) × h" },
        { pregunta: "Representa función cuadrática y = x² - 4x + 3", respuesta: "Parábola", explicacion: "Gráfico función cuadrática" },
        { pregunta: "Calcula desviación estándar de 2,4,4,4,5,5,7,9", respuesta: "2", explicacion: "Medida de dispersión" },
        { pregunta: "Homotecia con centro en (0,0) y escala -1", respuesta: "Reflejo respecto al origen", explicacion: "Escala negativa" },
        { pregunta: "Resuelve ecuación cuadrática x² - 5x + 6 = 0", respuesta: "2 y 3", explicacion: "Factorización" },
        { pregunta: "Representa nube de puntos y tendencia", respuesta: "Datos dispersos con línea", explicacion: "Gráficos XY" }
      ],
      "extremo": [
        { pregunta: "Demuestra identidad: (a+b)³", respuesta: "a³ + 3a²b + 3ab² + b³", explicacion: "Cubo de binomio" },
        { pregunta: "Resuelve sistema 3x + 2y - z = 7", respuesta: "Varía", explicacion: "Sistema con 3 variables" },
        { pregunta: "Calcula inversa función f(x) = 2x + 3", respuesta: "(x - 3)/2", explicacion: "Despeja x" },
        { pregunta: "Aplica homotecia con centro fuera del origen", respuesta: "Varía", explicacion: "Escala con traslación" },
        { pregunta: "Analiza correlación nube de puntos", respuesta: "Positiva, negativa o nula", explicacion: "Interpretación gráfica" },
        { pregunta: "Resuelve sistema no lineal simple", respuesta: "Varía", explicacion: "Ecuaciones no lineales" },
        { pregunta: "Calcula área bajo curva poligonal", respuesta: "Varía", explicacion: "Aproximación área" },
        { pregunta: "Demuestra propiedad distributiva", respuesta: "a(b + c) = ab + ac", explicacion: "Propiedad algebraica" }
      ]
    },
    "2medio": {
      "facil": [
        { pregunta: "Calcula raíz cuadrada de 49", respuesta: "7", explicacion: "Raíz cuadrada exacta" },
        { pregunta: "Evalúa: 2³", respuesta: "8", explicacion: "Potencia" },
        { pregunta: "Resuelve: log₁₀100", respuesta: "2", explicacion: "Logaritmo base 10" },
        { pregunta: "Simplifica: (x²)³", respuesta: "x⁶", explicacion: "Potencia de potencia" },
        { pregunta: "Función cuadrática: y = x²", respuesta: "Parábola", explicacion: "Gráfico básico" },
        { pregunta: "Calcula cambio porcentual de 50 a 60", respuesta: "20%", explicacion: "Incremento porcentual" },
        { pregunta: "Suma: 3x² + 2x²", respuesta: "5x²", explicacion: "Términos semejantes" },
        { pregunta: "Ecuación cuadrática: x² - 9 = 0", respuesta: "3 y -3", explicacion: "Raíces reales" }
      ],
      "medio": [
        { pregunta: "Calcula log₂8", respuesta: "3", explicacion: "Potencia base 2" },
        { pregunta: "Resuelve función inversa f(x) = 3x - 5", respuesta: "(x + 5)/3", explicacion: "Despeja x" },
        { pregunta: "Calcula área triángulo base 10 altura 6", respuesta: "30", explicacion: "Área básica" },
        { pregunta: "Simplifica expresión: (2x)(3x²)", respuesta: "6x³", explicacion: "Multiplicación potencias" },
        { pregunta: "Calcula razón trigonométrica seno 30°", respuesta: "0.5", explicacion: "Definición seno" },
        { pregunta: "Calcula variable aleatoria finita", respuesta: "Varía", explicacion: "Ejemplo variable discreta" },
        { pregunta: "Ecuación cuadrática: x² + 5x + 6 = 0", respuesta: "-2 y -3", explicacion: "Raíces por factorización" },
        { pregunta: "Calcula función logarítmica y = log x", respuesta: "Definición", explicacion: "Propiedades logaritmos" }
      ],
      "dificil": [
        { pregunta: "Calcula potencia con exponente fraccionario: 27^(1/3)", respuesta: "3", explicacion: "Raíz cúbica" },
        { pregunta: "Resuelve ecuación cuadrática con fórmula", respuesta: "Varía", explicacion: "Fórmula general" },
        { pregunta: "Calcula cambio porcentual compuesto", respuesta: "Varía", explicacion: "Interés compuesto" },
        { pregunta: "Calcula función inversa de y = (x - 1)²", respuesta: "√y + 1", explicacion: "Raíz cuadrada" },
        { pregunta: "Calcula razones trigonométricas tangente 45°", respuesta: "1", explicacion: "Definición tangente" },
        { pregunta: "Calcula variable aleatoria discreta", respuesta: "Varía", explicacion: "Ejemplo concreto" },
        { pregunta: "Deriva función básica f(x) = x²", respuesta: "2x", explicacion: "Regla potencia" },
        { pregunta: "Simplifica expresión logarítmica", respuesta: "Varía", explicacion: "Propiedades logaritmos" }
      ],
      "extremo": [
        { pregunta: "Resuelve ecuación logarítmica avanzada", respuesta: "Varía", explicacion: "Problema complejo" },
        { pregunta: "Calcula función exponencial y = e^x", respuesta: "Definición", explicacion: "Constante e" },
        { pregunta: "Calcula derivada compuesta (regla cadena)", respuesta: "Varía", explicacion: "Derivación avanzada" },
        { pregunta: "Calcula integral definida ∫_0^1 x² dx", respuesta: "1/3", explicacion: "Integral básica" },
        { pregunta: "Calcula razón trigonométrica coseno 60°", respuesta: "0.5", explicacion: "Definición coseno" },
        { pregunta: "Calcula variable aleatoria continua", respuesta: "Varía", explicacion: "Ejemplo variable continua" },
        { pregunta: "Calcula límite lim x→0 (sin x)/x", respuesta: "1", explicacion: "Límite fundamental" },
        { pregunta: "Resuelve ecuación diferencial básica", respuesta: "Varía", explicacion: "Problema diferencial" }
      ]
    },
    "3medio": {
      "facil": [
        { pregunta: "Calcula i²", respuesta: "-1", explicacion: "Por definición i² = -1" },
        { pregunta: "Suma complejos: (3+2i)+(1+4i)", respuesta: "4+6i", explicacion: "Suma parte real e imaginaria" },
        { pregunta: "Multiplica (1+i)(1 - i)", respuesta: "2", explicacion: "Producto conjugados" },
        { pregunta: "Media de: 2,4,6,8,10", respuesta: "6", explicacion: "Suma y divide entre cantidad" },
        { pregunta: "Moda de: 1,2,2,3,3,3", respuesta: "3", explicacion: "Número que más se repite" },
        { pregunta: "Área circunferencia radio 7 cm", respuesta: "153.94", explicacion: "πr² = 3.14×49" },
        { pregunta: "Resuelve: e^0", respuesta: "1", explicacion: "Cualquier número a la 0 es 1" },
        { pregunta: "Calcula log₁₀1", respuesta: "0", explicacion: "log 1 es siempre 0" },
        { pregunta: "Resuelve x² + 2x + 1 = 0", respuesta: "-1", explicacion: "Perfect square trinomial" },
        { pregunta: "Encuentra inversa f(x) = x + 3", respuesta: "x - 3", explicacion: "Despeja x" }
      ],
      "medio": [
        { pregunta: "Multiplica: (2+3i)(1 - 2i)", respuesta: "8 - i", explicacion: "Distribuye y simplifica" },
        { pregunta: "Calcula desviación estándar", respuesta: "Varía", explicacion: "Medida de dispersión" },
        { pregunta: "Ecuación circunferencia centro (0,0) radio 5", respuesta: "x² + y² = 25", explicacion: "Ecuación estándar" },
        { pregunta: "Resuelve f(x)=x² - 4x + 3", respuesta: "1 y 3", explicacion: "Factoriza o usa fórmula" },
        { pregunta: "Calcula log e e", respuesta: "1", explicacion: "log e base e es 1" },
        { pregunta: "Calcula función exponencial", respuesta: "y = e^x", explicacion: "Definición" },
        { pregunta: "Suma: 2 + 2i + 3 - i", respuesta: "5 + i", explicacion: "Suma parte real e imaginaria" },
        { pregunta: "Area triángulo base 10 cm altura 7 cm", respuesta: "35", explicacion: "Área = base × altura / 2" },
        { pregunta: "Calcula f'(x) de x²", respuesta: "2x", explicacion: "Derivada básica" },
        { pregunta: "Representa función logarítmica", respuesta: "y = log x", explicacion: "Definición" }
      ],
      "dificil": [
        { pregunta: "Multiplica y simplifica: (3+4i)(3 - 4i)", respuesta: "25", explicacion: "Producto conjugados: a²+b²" },
        { pregunta: "Calcula varianza de conjunto de datos", respuesta: "Varía", explicacion: "Medida de dispersión" },
        { pregunta: "Ecuación circunferencia centro (2,3) radio 4", respuesta: "(x-2)² + (y-3)² = 16", explicacion: "Ecuación general" },
        { pregunta: "Calcula f''(x) de x³", respuesta: "6x", explicacion: "Segunda derivada" },
        { pregunta: "Resuelve ecuación exponencial", respuesta: "Varía", explicacion: "Función exponencial" },
        { pregunta: "Calcula logaritmo natural ln(e⁵)", respuesta: "5", explicacion: "Propiedad logaritmos" },
        { pregunta: "Resuelve sistema ecuaciones complejas", respuesta: "Varía", explicacion: "Sistema complejo" },
        { pregunta: "Deriva función logarítmica", respuesta: "1/x", explicacion: "Derivada log" },
        { pregunta: "Calcula límite lim x→∞ (1 + 1/x)^x", respuesta: "e", explicacion: "Definición de e" },
        { pregunta: "Área superficie esfera radio 3", respuesta: "113.1", explicacion: "4πr²" }
      ],
      "extremo": [
        { pregunta: "Calcula integral ∫ x² dx", respuesta: "x³/3 + C", explicacion: "Integral básica" },
        { pregunta: "Resuelve ecuación diferencial simple", respuesta: "Varía", explicacion: "Derivada e integral" },
        { pregunta: "Demuestra identidad trigonométrica", respuesta: "Varía", explicacion: "Relación trigonométrica" },
        { pregunta: "Calcula transformada de Fourier básica", respuesta: "Varía", explicacion: "Análisis de señales" },
        { pregunta: "Resuelve sistema no lineal complejo", respuesta: "Varía", explicacion: "Sistemas avanzados" },
        { pregunta: "Calcula límite complejo", respuesta: "Varía", explicacion: "Límites en cálculo" },
        { pregunta: "Calcula serie de Fourier", respuesta: "Varía", explicacion: "Series armónicas" },
        { pregunta: "Resuelve función implícita", respuesta: "Varía", explicacion: "Funciones implícitas" }
      ]
    },
    "4medio": {
      "facil": [
        { pregunta: "Simplifica: (x + y)²", respuesta: "x² + 2xy + y²", explicacion: "Producto notable" },
        { pregunta: "Calcula área triángulo base 5 altura 8", respuesta: "20", explicacion: "Área básica" },
        { pregunta: "Suma: 3x² + 4x²", respuesta: "7x²", explicacion: "Términos semejantes" },
        { pregunta: "Resuelve: x - 4 = 10", respuesta: "14", explicacion: "Despeja x" },
        { pregunta: "Representa función lineal", respuesta: "y = mx + b", explicacion: "Forma básica" },
        { pregunta: "Calcula probabilidad simple", respuesta: "Varía", explicacion: "Eventos simples" },
        { pregunta: "Calcula media y mediana", respuesta: "Varía", explicacion: "Medidas centrales" },
        { pregunta: "Calcula volumen cilindro radio 3 altura 7", respuesta: "197.92", explicacion: "πr²h" }
      ],
      "medio": [
        { pregunta: "Resuelve ecuación cuadrática", respuesta: "Varía", explicacion: "Solución con fórmula" },
        { pregunta: "Calcula función inversa", respuesta: "Varía", explicacion: "Despeja x" },
        { pregunta: "Calcula razón trigonométrica", respuesta: "Varía", explicacion: "Seno, coseno o tangente" },
        { pregunta: "Calcula probabilidad compuesta", respuesta: "Varía", explicacion: "Eventos compuestos" },
        { pregunta: "Calcula desviación estándar", respuesta: "Varía", explicacion: "Medida dispersión" },
        { pregunta: "Simplifica expresión algebraica", respuesta: "Varía", explicacion: "Factorización y suma" },
        { pregunta: "Calcula función exponencial", respuesta: "Varía", explicacion: "Definición y propiedades" },
        { pregunta: "Resuelve sistema de ecuaciones", respuesta: "Varía", explicacion: "Método sustitución o eliminación" }
      ],
      "dificil": [
        { pregunta: "Calcula integral definida", respuesta: "Varía", explicacion: "Cálculo integral" },
        { pregunta: "Calcula derivada de función compuesta", respuesta: "Varía", explicacion: "Regla cadena" },
        { pregunta: "Resuelve ecuación diferencial básica", respuesta: "Varía", explicacion: "Derivadas e integrales" },
        { pregunta: "Calcula serie de Taylor", respuesta: "Varía", explicacion: "Expansión de funciones" },
        { pregunta: "Calcula límite complejo", respuesta: "Varía", explicacion: "Límites en cálculo" },
        { pregunta: "Calcula probabilidad condicional", respuesta: "Varía", explicacion: "Eventos dependientes" },
        { pregunta: "Simplifica función trigonométrica", respuesta: "Varía", explicacion: "Identidades trigonométricas" },
        { pregunta: "Calcula volumen sólido revolución", respuesta: "Varía", explicacion: "Cálculo integral" }
      ],
      "extremo": [
        { pregunta: "Demuestra teorema algebraico", respuesta: "Varía", explicacion: "Prueba formal" },
        { pregunta: "Resuelve ecuación diferencial avanzada", respuesta: "Varía", explicacion: "Cálculo avanzado" },
        { pregunta: "Calcula transformada Laplace", respuesta: "Varía", explicacion: "Análisis matemático" },
        { pregunta: "Demuestra identidad trigonométrica avanzada", respuesta: "Varía", explicacion: "Relaciones trigonométricas" },
        { pregunta: "Calcula integral múltiple", respuesta: "Varía", explicacion: "Cálculo multivariable" },
        { pregunta: "Resuelve sistema ecuaciones no lineales", respuesta: "Varía", explicacion: "Métodos avanzados" },
        { pregunta: "Calcula serie de Fourier avanzada", respuesta: "Varía", explicacion: "Análisis armónico" },
        { pregunta: "Analiza función implícita avanzada", respuesta: "Varía", explicacion: "Cálculo avanzado" }
      ]
    }
  };

  const tiemposDificultad = {
    facil: 8 * 60,
    medio: 6 * 60,
    dificil: 4 * 60,
    extremo: 3 * 60
  };

  const board = document.getElementById("board");
  const cursoSelect = document.getElementById("curso-select");
  const dificultadSelect = document.getElementById("dificultad-select");
  const startBtn = document.getElementById("start-btn");
  const explanationDiv = document.getElementById("explanation");
  const scoreboard = document.getElementById("scoreboard");
  const timerDisplay = document.getElementById("timer");

  let cursoActual = cursoSelect.value;
  let dificultadActual = dificultadSelect.value;
  let puntaje = 0;
  let cartasSeleccionadas = [];
  let temporizador = null;
  let tiempoRestante = 0;
  let bloqueoClick = false;

  function mezclarArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function crearCartas() {
    // Reiniciar variables
    puntaje = 0;
    actualizarPuntaje();
    cartasSeleccionadas = [];
    explanationDiv.textContent = "";
    clearInterval(temporizador);

    cursoActual = cursoSelect.value;
    dificultadActual = dificultadSelect.value;

    const ejercicios = bancoOperaciones[cursoActual][dificultadActual];
    if (!ejercicios) {
      alert("No hay ejercicios para esta combinación.");
      return;
    }

    // Limpiar tablero
    board.innerHTML = "";
    board.className = "board-" + dificultadActual;

    // Seleccionar 8 pares de ejercicios para total 16 cartas
    const seleccion = mezclarArray(ejercicios).slice(0, 8);

    // Crear cartas: para cada ejercicio, crear dos cartas (pregunta y respuesta)
    const cartas = [];
    seleccion.forEach((item, index) => {
      cartas.push({
        id: index,
        tipo: "pregunta",
        text: item.pregunta,
        explicacion: item.explicacion
      });
      cartas.push({
        id: index,
        tipo: "respuesta",
        text: item.respuesta,
        explicacion: item.explicacion
      });
    });

    mezclarArray(cartas);

    // Crear elementos DOM
    cartas.forEach(c => {
      const cardDiv = document.createElement("div");
      cardDiv.classList.add("card");
      cardDiv.dataset.id = c.id;
      cardDiv.dataset.tipo = c.tipo;
      cardDiv.dataset.text = c.text;
      cardDiv.dataset.explicacion = c.explicacion;
      cardDiv.textContent = ""; // texto oculto al inicio
      cardDiv.addEventListener("click", manejarClickCarta);
      board.appendChild(cardDiv);
    });

    iniciarTemporizador();
  }

  function manejarClickCarta(e) {
    if (bloqueoClick) return;

    const carta = e.currentTarget;
    if (carta.classList.contains("flipped") || carta.classList.contains("matched")) return;

    carta.classList.add("flipped");
    carta.textContent = carta.dataset.text;

    cartasSeleccionadas.push(carta);

    if (cartasSeleccionadas.length === 2) {
      bloqueoClick = true;
      const [primera, segunda] = cartasSeleccionadas;

      if (
        primera.dataset.id === segunda.dataset.id &&
        primera.dataset.tipo !== segunda.dataset.tipo
      ) {
        // Par correcto
        primera.classList.add("matched");
        segunda.classList.add("matched");
        puntaje += 10;
        explanationDiv.textContent = "¡Correcto! " + primera.dataset.explicacion;

        setTimeout(() => {
          bloqueoClick = false;
          explanationDiv.textContent = "";
          revisarFinJuego();
        }, 1500);
      } else {
        // Par incorrecto
        puntaje = Math.max(0, puntaje - 5);
        explanationDiv.textContent = "Incorrecto. " + (segunda.dataset.explicacion || "Revisa bien el ejercicio.");

        primera.classList.add("wrong");
        segunda.classList.add("wrong");

        setTimeout(() => {
          primera.classList.remove("flipped", "wrong");
          segunda.classList.remove("flipped", "wrong");
          primera.textContent = "";
          segunda.textContent = "";
          explanationDiv.textContent = "";
          bloqueoClick = false;
        }, 1500);
      }
      actualizarPuntaje();
      cartasSeleccionadas = [];
    }
  }

  function actualizarPuntaje() {
    scoreboard.textContent = `Puntaje: ${puntaje}`;
  }

  function revisarFinJuego() {
    const todasCartas = Array.from(board.querySelectorAll(".card"));
    if (todasCartas.every(c => c.classList.contains("matched"))) {
      clearInterval(temporizador);
      explanationDiv.textContent = "¡Felicidades! Terminaste el juego.";
      bloquearCartas();
    }
  }

  function iniciarTemporizador() {
    clearInterval(temporizador);
    tiempoRestante = tiemposDificultad[dificultadActual];
    actualizarTiempo();
    temporizador = setInterval(() => {
      tiempoRestante--;
      actualizarTiempo();
      if (tiempoRestante <= 0) {
        clearInterval(temporizador);
        explanationDiv.textContent = "¡Se acabó el tiempo!";
        bloquearCartas();
        bloqueoClick = true;
      }
    }, 1000);
  }

  function actualizarTiempo() {
    const minutos = Math.floor(tiempoRestante / 60).toString().padStart(2, "0");
    const segundos = (tiempoRestante % 60).toString().padStart(2, "0");
    timerDisplay.textContent = `Tiempo: ${minutos}:${segundos}`;
  }

  function bloquearCartas() {
    const todasCartas = Array.from(board.querySelectorAll(".card"));
    todasCartas.forEach(c => {
      c.removeEventListener("click", manejarClickCarta);
      c.classList.add("flipped");
      c.textContent = c.dataset.text;
    });
  }

  startBtn.addEventListener("click", crearCartas);

  cursoSelect.addEventListener("change", () => {
    cursoActual = cursoSelect.value;
  });

  dificultadSelect.addEventListener("change", () => {
    dificultadActual = dificultadSelect.value;
    board.className = "board-" + dificultadActual;
  });

  // Inicializar color y timer vacío
  board.className = "board-" + dificultadActual;
  timerDisplay.textContent = "Tiempo: 00:00";
</script>

</body>
</html>
